Starting training for attn_ugru_hc model
Device: cuda, Epochs: 30, Batch size: 64
LR: 0.001, Warmup: 1 epochs, Grad clip: 1.0
Mixed precision: True
Early stopping: patience=30 epochs (based on val loss)

============================================================
Epoch 1/30
============================================================
Learning rate: 0.000001
Epoch 1/30 | Train Loss: 2.6105, Val Loss: 0.9221 | Train Acc#: 0.3907, Val Acc#: 0.7666
Saved best checkpoint: outputs/checkpoints/attn_ugru_hc_best.pth (Val Acc: 0.7666)

============================================================
Epoch 2/30
============================================================
Epoch 2/30 | Train Loss: 0.4871, Val Loss: 0.3154 | Train Acc#: 0.8924, Val Acc#: 0.9268
Saved best checkpoint: outputs/checkpoints/attn_ugru_hc_best.pth (Val Acc: 0.9268)

============================================================
Epoch 3/30
============================================================
Epoch 3/30 | Train Loss: 0.1718, Val Loss: 0.1507 | Train Acc#: 0.9716, Val Acc#: 0.9721
Saved best checkpoint: outputs/checkpoints/attn_ugru_hc_best.pth (Val Acc: 0.9721)

============================================================
Epoch 4/30
============================================================
Epoch 4/30 | Train Loss: 0.0884, Val Loss: 0.1448 | Train Acc#: 0.9865, Val Acc#: 0.9686

============================================================
Epoch 5/30
============================================================
Learning rate: 0.000097
Epoch 5/30 | Train Loss: 0.0616, Val Loss: 0.1244 | Train Acc#: 0.9895, Val Acc#: 0.9634

============================================================
Epoch 6/30
============================================================
Epoch 6/30 | Train Loss: 0.0370, Val Loss: 0.0979 | Train Acc#: 0.9938, Val Acc#: 0.9686

============================================================
Epoch 7/30
============================================================
Epoch 7/30 | Train Loss: 0.0264, Val Loss: 0.1324 | Train Acc#: 0.9955, Val Acc#: 0.9686 | No improvement: 1/30

============================================================
Epoch 8/30
============================================================
Epoch 8/30 | Train Loss: 0.0224, Val Loss: 0.1069 | Train Acc#: 0.9957, Val Acc#: 0.9826 | No improvement: 2/30
Saved best checkpoint: outputs/checkpoints/attn_ugru_hc_best.pth (Val Acc: 0.9826)

============================================================
Epoch 9/30
============================================================
Epoch 9/30 | Train Loss: 0.0202, Val Loss: 0.1056 | Train Acc#: 0.9957, Val Acc#: 0.9739 | No improvement: 3/30

============================================================
Epoch 10/30
============================================================
Learning rate: 0.000082
Epoch 10/30 | Train Loss: 0.0134, Val Loss: 0.0815 | Train Acc#: 0.9979, Val Acc#: 0.9721

============================================================
Epoch 11/30
============================================================
Epoch 11/30 | Train Loss: 0.0139, Val Loss: 0.0906 | Train Acc#: 0.9962, Val Acc#: 0.9756 | No improvement: 1/30

============================================================
Epoch 12/30
============================================================
Epoch 12/30 | Train Loss: 0.0085, Val Loss: 0.0777 | Train Acc#: 0.9987, Val Acc#: 0.9826

============================================================
Epoch 13/30
============================================================
Epoch 13/30 | Train Loss: 0.0079, Val Loss: 0.0729 | Train Acc#: 0.9989, Val Acc#: 0.9843
Saved best checkpoint: outputs/checkpoints/attn_ugru_hc_best.pth (Val Acc: 0.9843)

============================================================
Epoch 14/30
============================================================
Epoch 14/30 | Train Loss: 0.0065, Val Loss: 0.0612 | Train Acc#: 0.9987, Val Acc#: 0.9791

============================================================
Epoch 15/30
============================================================
Learning rate: 0.000058
Epoch 15/30 | Train Loss: 0.0050, Val Loss: 0.0751 | Train Acc#: 0.9989, Val Acc#: 0.9826 | No improvement: 1/30

============================================================
Epoch 16/30
============================================================
Epoch 16/30 | Train Loss: 0.0049, Val Loss: 0.0744 | Train Acc#: 0.9991, Val Acc#: 0.9843 | No improvement: 2/30

============================================================
Epoch 17/30
============================================================
Epoch 17/30 | Train Loss: 0.0041, Val Loss: 0.0626 | Train Acc#: 0.9994, Val Acc#: 0.9843 | No improvement: 3/30

============================================================
Epoch 18/30
============================================================
Epoch 18/30 | Train Loss: 0.0029, Val Loss: 0.0686 | Train Acc#: 0.9998, Val Acc#: 0.9826 | No improvement: 4/30

============================================================
Epoch 19/30
============================================================
Epoch 19/30 | Train Loss: 0.0026, Val Loss: 0.0663 | Train Acc#: 0.9998, Val Acc#: 0.9861 | No improvement: 5/30
Saved best checkpoint: outputs/checkpoints/attn_ugru_hc_best.pth (Val Acc: 0.9861)

============================================================
Epoch 20/30
============================================================
Learning rate: 0.000031
Epoch 20/30 | Train Loss: 0.0028, Val Loss: 0.0680 | Train Acc#: 0.9996, Val Acc#: 0.9861 | No improvement: 6/30

============================================================
Epoch 21/30
============================================================
Epoch 21/30 | Train Loss: 0.0023, Val Loss: 0.0647 | Train Acc#: 0.9998, Val Acc#: 0.9826 | No improvement: 7/30

============================================================
Epoch 22/30
============================================================
Epoch 22/30 | Train Loss: 0.0024, Val Loss: 0.0619 | Train Acc#: 0.9998, Val Acc#: 0.9878 | No improvement: 8/30
Saved best checkpoint: outputs/checkpoints/attn_ugru_hc_best.pth (Val Acc: 0.9878)

============================================================
Epoch 23/30
============================================================
Epoch 23/30 | Train Loss: 0.0022, Val Loss: 0.0636 | Train Acc#: 0.9998, Val Acc#: 0.9878 | No improvement: 9/30

============================================================
Epoch 24/30
============================================================
Epoch 24/30 | Train Loss: 0.0022, Val Loss: 0.0744 | Train Acc#: 0.9998, Val Acc#: 0.9878 | No improvement: 10/30

============================================================
Epoch 25/30
============================================================
Learning rate: 0.000010
Epoch 25/30 | Train Loss: 0.0021, Val Loss: 0.0730 | Train Acc#: 0.9998, Val Acc#: 0.9878 | No improvement: 11/30

============================================================
Epoch 26/30
============================================================
Epoch 26/30 | Train Loss: 0.0022, Val Loss: 0.0661 | Train Acc#: 0.9998, Val Acc#: 0.9843 | No improvement: 12/30

============================================================
Epoch 27/30
============================================================
Epoch 27/30 | Train Loss: 0.0021, Val Loss: 0.0675 | Train Acc#: 0.9996, Val Acc#: 0.9878 | No improvement: 13/30

============================================================
Epoch 28/30
============================================================
Epoch 28/30 | Train Loss: 0.0020, Val Loss: 0.0691 | Train Acc#: 1.0000, Val Acc#: 0.9808 | No improvement: 14/30

============================================================
Epoch 29/30
============================================================
Epoch 29/30 | Train Loss: 0.0021, Val Loss: 0.0728 | Train Acc#: 0.9996, Val Acc#: 0.9843 | No improvement: 15/30

============================================================
Epoch 30/30
============================================================
Learning rate: 0.000000
Epoch 30/30 | Train Loss: 0.0020, Val Loss: 0.0701 | Train Acc#: 0.9998, Val Acc#: 0.9843 | No improvement: 16/30

Evaluating on test set with best model...
Test Metrics:
  Loss: 0.1142
  Acc Number: 0.9811
  Acc Tens: 0.9966
  Acc Ones: 0.9828
