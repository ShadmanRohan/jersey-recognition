Starting training for attn_bgru_bahdanau model
Device: cuda, Epochs: 30, Batch size: 64
LR: 0.001, Warmup: 1 epochs, Grad clip: 1.0
Mixed precision: True
Early stopping: patience=30 epochs (based on val loss)

============================================================
Epoch 1/30
============================================================
Learning rate: 0.000001
Epoch 1/30 | Train Loss: 2.4172, Val Loss: 0.7699 | Train Acc#: 0.3867, Val Acc#: 0.7509
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.7509)

============================================================
Epoch 2/30
============================================================
Epoch 2/30 | Train Loss: 0.3388, Val Loss: 0.2256 | Train Acc#: 0.9115, Val Acc#: 0.9512
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9512)

============================================================
Epoch 3/30
============================================================
Epoch 3/30 | Train Loss: 0.1218, Val Loss: 0.1699 | Train Acc#: 0.9718, Val Acc#: 0.9530
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9530)

============================================================
Epoch 4/30
============================================================
Epoch 4/30 | Train Loss: 0.0817, Val Loss: 0.2124 | Train Acc#: 0.9784, Val Acc#: 0.9408 | No improvement: 1/30

============================================================
Epoch 5/30
============================================================
Learning rate: 0.000097
Epoch 5/30 | Train Loss: 0.0626, Val Loss: 0.1884 | Train Acc#: 0.9831, Val Acc#: 0.9460 | No improvement: 2/30

============================================================
Epoch 6/30
============================================================
Epoch 6/30 | Train Loss: 0.0426, Val Loss: 0.1634 | Train Acc#: 0.9876, Val Acc#: 0.9512

============================================================
Epoch 7/30
============================================================
Epoch 7/30 | Train Loss: 0.0346, Val Loss: 0.1281 | Train Acc#: 0.9897, Val Acc#: 0.9739
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9739)

============================================================
Epoch 8/30
============================================================
Epoch 8/30 | Train Loss: 0.0276, Val Loss: 0.1918 | Train Acc#: 0.9934, Val Acc#: 0.9564 | No improvement: 1/30

============================================================
Epoch 9/30
============================================================
Epoch 9/30 | Train Loss: 0.0147, Val Loss: 0.1866 | Train Acc#: 0.9964, Val Acc#: 0.9617 | No improvement: 2/30

============================================================
Epoch 10/30
============================================================
Learning rate: 0.000082
Epoch 10/30 | Train Loss: 0.0110, Val Loss: 0.1064 | Train Acc#: 0.9972, Val Acc#: 0.9739

============================================================
Epoch 11/30
============================================================
Epoch 11/30 | Train Loss: 0.0118, Val Loss: 0.1110 | Train Acc#: 0.9972, Val Acc#: 0.9756 | No improvement: 1/30
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9756)

============================================================
Epoch 12/30
============================================================
Epoch 12/30 | Train Loss: 0.0103, Val Loss: 0.1272 | Train Acc#: 0.9972, Val Acc#: 0.9739 | No improvement: 2/30

============================================================
Epoch 13/30
============================================================
Epoch 13/30 | Train Loss: 0.0084, Val Loss: 0.0912 | Train Acc#: 0.9979, Val Acc#: 0.9791
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9791)

============================================================
Epoch 14/30
============================================================
Epoch 14/30 | Train Loss: 0.0094, Val Loss: 0.0994 | Train Acc#: 0.9979, Val Acc#: 0.9791 | No improvement: 1/30

============================================================
Epoch 15/30
============================================================
Learning rate: 0.000058
Epoch 15/30 | Train Loss: 0.0034, Val Loss: 0.1120 | Train Acc#: 0.9994, Val Acc#: 0.9756 | No improvement: 2/30

============================================================
Epoch 16/30
============================================================
Epoch 16/30 | Train Loss: 0.0058, Val Loss: 0.1105 | Train Acc#: 0.9981, Val Acc#: 0.9791 | No improvement: 3/30

============================================================
Epoch 17/30
============================================================
Epoch 17/30 | Train Loss: 0.0034, Val Loss: 0.0956 | Train Acc#: 0.9989, Val Acc#: 0.9791 | No improvement: 4/30

============================================================
Epoch 18/30
============================================================
Epoch 18/30 | Train Loss: 0.0016, Val Loss: 0.0963 | Train Acc#: 0.9996, Val Acc#: 0.9791 | No improvement: 5/30

============================================================
Epoch 19/30
============================================================
Epoch 19/30 | Train Loss: 0.0021, Val Loss: 0.1046 | Train Acc#: 0.9996, Val Acc#: 0.9791 | No improvement: 6/30

============================================================
Epoch 20/30
============================================================
Learning rate: 0.000031
Epoch 20/30 | Train Loss: 0.0018, Val Loss: 0.0869 | Train Acc#: 0.9994, Val Acc#: 0.9843
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9843)

============================================================
Epoch 21/30
============================================================
Epoch 21/30 | Train Loss: 0.0013, Val Loss: 0.1018 | Train Acc#: 0.9998, Val Acc#: 0.9791 | No improvement: 1/30

============================================================
Epoch 22/30
============================================================
Epoch 22/30 | Train Loss: 0.0013, Val Loss: 0.0888 | Train Acc#: 0.9996, Val Acc#: 0.9808 | No improvement: 2/30

============================================================
Epoch 23/30
============================================================
Epoch 23/30 | Train Loss: 0.0012, Val Loss: 0.1037 | Train Acc#: 0.9998, Val Acc#: 0.9791 | No improvement: 3/30

============================================================
Epoch 24/30
============================================================
Epoch 24/30 | Train Loss: 0.0015, Val Loss: 0.1018 | Train Acc#: 0.9996, Val Acc#: 0.9791 | No improvement: 4/30

============================================================
Epoch 25/30
============================================================
Learning rate: 0.000010
Epoch 25/30 | Train Loss: 0.0029, Val Loss: 0.0998 | Train Acc#: 0.9991, Val Acc#: 0.9774 | No improvement: 5/30

============================================================
Epoch 26/30
============================================================
Epoch 26/30 | Train Loss: 0.0010, Val Loss: 0.1035 | Train Acc#: 0.9998, Val Acc#: 0.9791 | No improvement: 6/30

============================================================
Epoch 27/30
============================================================
Epoch 27/30 | Train Loss: 0.0014, Val Loss: 0.1083 | Train Acc#: 0.9996, Val Acc#: 0.9826 | No improvement: 7/30

============================================================
Epoch 28/30
============================================================
Epoch 28/30 | Train Loss: 0.0010, Val Loss: 0.1025 | Train Acc#: 0.9996, Val Acc#: 0.9791 | No improvement: 8/30

============================================================
Epoch 29/30
============================================================
Epoch 29/30 | Train Loss: 0.0010, Val Loss: 0.1053 | Train Acc#: 0.9998, Val Acc#: 0.9791 | No improvement: 9/30

============================================================
Epoch 30/30
============================================================
Learning rate: 0.000000
Epoch 30/30 | Train Loss: 0.0024, Val Loss: 0.1005 | Train Acc#: 0.9998, Val Acc#: 0.9791 | No improvement: 10/30

Evaluating on test set with best model...
Test Metrics:
  Loss: 0.1453
  Acc Number: 0.9759
  Acc Tens: 0.9948
  Acc Ones: 0.9777
