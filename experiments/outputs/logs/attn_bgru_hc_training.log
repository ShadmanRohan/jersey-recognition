Starting training for attn_bgru_hc model
Device: cuda, Epochs: 30, Batch size: 64
LR: 0.001, Warmup: 1 epochs, Grad clip: 1.0
Mixed precision: True
Early stopping: patience=30 epochs (based on val loss)

============================================================
Epoch 1/30
============================================================
Learning rate: 0.000001
Epoch 1/30 | Train Loss: 2.2445, Val Loss: 0.7344 | Train Acc#: 0.4262, Val Acc#: 0.7962
Saved best checkpoint: outputs/checkpoints/attn_bgru_hc_best.pth (Val Acc: 0.7962)

============================================================
Epoch 2/30
============================================================
Epoch 2/30 | Train Loss: 0.3291, Val Loss: 0.2356 | Train Acc#: 0.9136, Val Acc#: 0.9373
Saved best checkpoint: outputs/checkpoints/attn_bgru_hc_best.pth (Val Acc: 0.9373)

============================================================
Epoch 3/30
============================================================
Epoch 3/30 | Train Loss: 0.1128, Val Loss: 0.1798 | Train Acc#: 0.9741, Val Acc#: 0.9495
Saved best checkpoint: outputs/checkpoints/attn_bgru_hc_best.pth (Val Acc: 0.9495)

============================================================
Epoch 4/30
============================================================
Epoch 4/30 | Train Loss: 0.0772, Val Loss: 0.1203 | Train Acc#: 0.9831, Val Acc#: 0.9686
Saved best checkpoint: outputs/checkpoints/attn_bgru_hc_best.pth (Val Acc: 0.9686)

============================================================
Epoch 5/30
============================================================
Learning rate: 0.000097
Epoch 5/30 | Train Loss: 0.0482, Val Loss: 0.1531 | Train Acc#: 0.9870, Val Acc#: 0.9512 | No improvement: 1/30

============================================================
Epoch 6/30
============================================================
Epoch 6/30 | Train Loss: 0.0340, Val Loss: 0.0952 | Train Acc#: 0.9919, Val Acc#: 0.9721
Saved best checkpoint: outputs/checkpoints/attn_bgru_hc_best.pth (Val Acc: 0.9721)

============================================================
Epoch 7/30
============================================================
Epoch 7/30 | Train Loss: 0.0219, Val Loss: 0.1090 | Train Acc#: 0.9936, Val Acc#: 0.9686 | No improvement: 1/30

============================================================
Epoch 8/30
============================================================
Epoch 8/30 | Train Loss: 0.0216, Val Loss: 0.0834 | Train Acc#: 0.9942, Val Acc#: 0.9791
Saved best checkpoint: outputs/checkpoints/attn_bgru_hc_best.pth (Val Acc: 0.9791)

============================================================
Epoch 9/30
============================================================
Epoch 9/30 | Train Loss: 0.0129, Val Loss: 0.1316 | Train Acc#: 0.9970, Val Acc#: 0.9704 | No improvement: 1/30

============================================================
Epoch 10/30
============================================================
Learning rate: 0.000082
Epoch 10/30 | Train Loss: 0.0084, Val Loss: 0.0924 | Train Acc#: 0.9979, Val Acc#: 0.9774 | No improvement: 2/30

============================================================
Epoch 11/30
============================================================
Epoch 11/30 | Train Loss: 0.0086, Val Loss: 0.1095 | Train Acc#: 0.9983, Val Acc#: 0.9721 | No improvement: 3/30

============================================================
Epoch 12/30
============================================================
Epoch 12/30 | Train Loss: 0.0089, Val Loss: 0.1278 | Train Acc#: 0.9981, Val Acc#: 0.9721 | No improvement: 4/30

============================================================
Epoch 13/30
============================================================
Epoch 13/30 | Train Loss: 0.0063, Val Loss: 0.0867 | Train Acc#: 0.9985, Val Acc#: 0.9774 | No improvement: 5/30

============================================================
Epoch 14/30
============================================================
Epoch 14/30 | Train Loss: 0.0044, Val Loss: 0.1048 | Train Acc#: 0.9987, Val Acc#: 0.9774 | No improvement: 6/30

============================================================
Epoch 15/30
============================================================
Learning rate: 0.000058
Epoch 15/30 | Train Loss: 0.0034, Val Loss: 0.0643 | Train Acc#: 0.9996, Val Acc#: 0.9808
Saved best checkpoint: outputs/checkpoints/attn_bgru_hc_best.pth (Val Acc: 0.9808)

============================================================
Epoch 16/30
============================================================
Epoch 16/30 | Train Loss: 0.0032, Val Loss: 0.0640 | Train Acc#: 0.9989, Val Acc#: 0.9843
Saved best checkpoint: outputs/checkpoints/attn_bgru_hc_best.pth (Val Acc: 0.9843)

============================================================
Epoch 17/30
============================================================
Epoch 17/30 | Train Loss: 0.0033, Val Loss: 0.0701 | Train Acc#: 0.9991, Val Acc#: 0.9826 | No improvement: 1/30

============================================================
Epoch 18/30
============================================================
Epoch 18/30 | Train Loss: 0.0041, Val Loss: 0.0595 | Train Acc#: 0.9987, Val Acc#: 0.9861
Saved best checkpoint: outputs/checkpoints/attn_bgru_hc_best.pth (Val Acc: 0.9861)

============================================================
Epoch 19/30
============================================================
Epoch 19/30 | Train Loss: 0.0027, Val Loss: 0.0621 | Train Acc#: 0.9996, Val Acc#: 0.9826 | No improvement: 1/30

============================================================
Epoch 20/30
============================================================
Learning rate: 0.000031
Epoch 20/30 | Train Loss: 0.0013, Val Loss: 0.0646 | Train Acc#: 0.9998, Val Acc#: 0.9826 | No improvement: 2/30

============================================================
Epoch 21/30
============================================================
Epoch 21/30 | Train Loss: 0.0014, Val Loss: 0.0562 | Train Acc#: 0.9998, Val Acc#: 0.9861

============================================================
Epoch 22/30
============================================================
Epoch 22/30 | Train Loss: 0.0014, Val Loss: 0.0602 | Train Acc#: 0.9996, Val Acc#: 0.9861 | No improvement: 1/30

============================================================
Epoch 23/30
============================================================
Epoch 23/30 | Train Loss: 0.0014, Val Loss: 0.0617 | Train Acc#: 0.9996, Val Acc#: 0.9843 | No improvement: 2/30

============================================================
Epoch 24/30
============================================================
Epoch 24/30 | Train Loss: 0.0029, Val Loss: 0.0595 | Train Acc#: 0.9991, Val Acc#: 0.9843 | No improvement: 3/30

============================================================
Epoch 25/30
============================================================
Learning rate: 0.000010
Epoch 25/30 | Train Loss: 0.0011, Val Loss: 0.0573 | Train Acc#: 0.9998, Val Acc#: 0.9826 | No improvement: 4/30

============================================================
Epoch 26/30
============================================================
Epoch 26/30 | Train Loss: 0.0013, Val Loss: 0.0545 | Train Acc#: 0.9998, Val Acc#: 0.9861

============================================================
Epoch 27/30
============================================================
Epoch 27/30 | Train Loss: 0.0010, Val Loss: 0.0565 | Train Acc#: 0.9998, Val Acc#: 0.9843 | No improvement: 1/30

============================================================
Epoch 28/30
============================================================
Epoch 28/30 | Train Loss: 0.0010, Val Loss: 0.0562 | Train Acc#: 0.9998, Val Acc#: 0.9843 | No improvement: 2/30

============================================================
Epoch 29/30
============================================================
Epoch 29/30 | Train Loss: 0.0014, Val Loss: 0.0547 | Train Acc#: 0.9996, Val Acc#: 0.9861 | No improvement: 3/30

============================================================
Epoch 30/30
============================================================
Learning rate: 0.000000
Epoch 30/30 | Train Loss: 0.0023, Val Loss: 0.0581 | Train Acc#: 0.9991, Val Acc#: 0.9843 | No improvement: 4/30

Evaluating on test set with best model...
Test Metrics:
  Loss: 0.1234
  Acc Number: 0.9794
  Acc Tens: 0.9966
  Acc Ones: 0.9811
