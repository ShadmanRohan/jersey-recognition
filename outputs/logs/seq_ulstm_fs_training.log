Starting training for seq_ulstm_fs model
Device: cuda, Epochs: 30, Batch size: 64
LR: 0.001, Warmup: 1 epochs, Grad clip: 1.0
Mixed precision: True
Early stopping: patience=30 epochs (based on val loss)

============================================================
Epoch 1/30
============================================================
Learning rate: 0.000001
Epoch 1/30 | Train Loss: 3.0741, Val Loss: 1.2675 | Train Acc#: 0.3385, Val Acc#: 0.6533
Saved best checkpoint: outputs/checkpoints/seq_ulstm_fs_best.pth (Val Acc: 0.6533)

============================================================
Epoch 2/30
============================================================
Epoch 2/30 | Train Loss: 0.6721, Val Loss: 0.4661 | Train Acc#: 0.8293, Val Acc#: 0.8990
Saved best checkpoint: outputs/checkpoints/seq_ulstm_fs_best.pth (Val Acc: 0.8990)

============================================================
Epoch 3/30
============================================================
Epoch 3/30 | Train Loss: 0.2418, Val Loss: 0.2368 | Train Acc#: 0.9542, Val Acc#: 0.9408
Saved best checkpoint: outputs/checkpoints/seq_ulstm_fs_best.pth (Val Acc: 0.9408)

============================================================
Epoch 4/30
============================================================
Epoch 4/30 | Train Loss: 0.1311, Val Loss: 0.2274 | Train Acc#: 0.9731, Val Acc#: 0.9373

============================================================
Epoch 5/30
============================================================
Learning rate: 0.000097
Epoch 5/30 | Train Loss: 0.0893, Val Loss: 0.1904 | Train Acc#: 0.9816, Val Acc#: 0.9443
Saved best checkpoint: outputs/checkpoints/seq_ulstm_fs_best.pth (Val Acc: 0.9443)

============================================================
Epoch 6/30
============================================================
Epoch 6/30 | Train Loss: 0.0654, Val Loss: 0.1390 | Train Acc#: 0.9867, Val Acc#: 0.9617
Saved best checkpoint: outputs/checkpoints/seq_ulstm_fs_best.pth (Val Acc: 0.9617)

============================================================
Epoch 7/30
============================================================
Epoch 7/30 | Train Loss: 0.0459, Val Loss: 0.1486 | Train Acc#: 0.9914, Val Acc#: 0.9634 | No improvement: 1/30
Saved best checkpoint: outputs/checkpoints/seq_ulstm_fs_best.pth (Val Acc: 0.9634)

============================================================
Epoch 8/30
============================================================
Epoch 8/30 | Train Loss: 0.0387, Val Loss: 0.1146 | Train Acc#: 0.9910, Val Acc#: 0.9739
Saved best checkpoint: outputs/checkpoints/seq_ulstm_fs_best.pth (Val Acc: 0.9739)

============================================================
Epoch 9/30
============================================================
Epoch 9/30 | Train Loss: 0.0304, Val Loss: 0.1118 | Train Acc#: 0.9934, Val Acc#: 0.9721

============================================================
Epoch 10/30
============================================================
Learning rate: 0.000082
Epoch 10/30 | Train Loss: 0.0234, Val Loss: 0.1308 | Train Acc#: 0.9957, Val Acc#: 0.9721 | No improvement: 1/30

============================================================
Epoch 11/30
============================================================
Epoch 11/30 | Train Loss: 0.0171, Val Loss: 0.0902 | Train Acc#: 0.9966, Val Acc#: 0.9791
Saved best checkpoint: outputs/checkpoints/seq_ulstm_fs_best.pth (Val Acc: 0.9791)

============================================================
Epoch 12/30
============================================================
Epoch 12/30 | Train Loss: 0.0138, Val Loss: 0.0896 | Train Acc#: 0.9974, Val Acc#: 0.9756

============================================================
Epoch 13/30
============================================================
Epoch 13/30 | Train Loss: 0.0148, Val Loss: 0.1059 | Train Acc#: 0.9972, Val Acc#: 0.9739 | No improvement: 1/30

============================================================
Epoch 14/30
============================================================
Epoch 14/30 | Train Loss: 0.0130, Val Loss: 0.0975 | Train Acc#: 0.9972, Val Acc#: 0.9756 | No improvement: 2/30

============================================================
Epoch 15/30
============================================================
Learning rate: 0.000058
Epoch 15/30 | Train Loss: 0.0073, Val Loss: 0.0969 | Train Acc#: 0.9989, Val Acc#: 0.9774 | No improvement: 3/30

============================================================
Epoch 16/30
============================================================
Epoch 16/30 | Train Loss: 0.0076, Val Loss: 0.1126 | Train Acc#: 0.9983, Val Acc#: 0.9739 | No improvement: 4/30

============================================================
Epoch 17/30
============================================================
Epoch 17/30 | Train Loss: 0.0070, Val Loss: 0.1147 | Train Acc#: 0.9985, Val Acc#: 0.9669 | No improvement: 5/30

============================================================
Epoch 18/30
============================================================
Epoch 18/30 | Train Loss: 0.0047, Val Loss: 0.1055 | Train Acc#: 0.9989, Val Acc#: 0.9721 | No improvement: 6/30

============================================================
Epoch 19/30
============================================================
Epoch 19/30 | Train Loss: 0.0032, Val Loss: 0.1138 | Train Acc#: 0.9998, Val Acc#: 0.9774 | No improvement: 7/30

============================================================
Epoch 20/30
============================================================
Learning rate: 0.000031
Epoch 20/30 | Train Loss: 0.0030, Val Loss: 0.1182 | Train Acc#: 0.9998, Val Acc#: 0.9756 | No improvement: 8/30

============================================================
Epoch 21/30
============================================================
Epoch 21/30 | Train Loss: 0.0032, Val Loss: 0.1096 | Train Acc#: 0.9994, Val Acc#: 0.9774 | No improvement: 9/30

============================================================
Epoch 22/30
============================================================
Epoch 22/30 | Train Loss: 0.0027, Val Loss: 0.1228 | Train Acc#: 0.9998, Val Acc#: 0.9791 | No improvement: 10/30

============================================================
Epoch 23/30
============================================================
Epoch 23/30 | Train Loss: 0.0045, Val Loss: 0.1088 | Train Acc#: 0.9994, Val Acc#: 0.9739 | No improvement: 11/30

============================================================
Epoch 24/30
============================================================
Epoch 24/30 | Train Loss: 0.0024, Val Loss: 0.0949 | Train Acc#: 0.9998, Val Acc#: 0.9808 | No improvement: 12/30
Saved best checkpoint: outputs/checkpoints/seq_ulstm_fs_best.pth (Val Acc: 0.9808)

============================================================
Epoch 25/30
============================================================
Learning rate: 0.000010
Epoch 25/30 | Train Loss: 0.0031, Val Loss: 0.0967 | Train Acc#: 0.9994, Val Acc#: 0.9791 | No improvement: 13/30

============================================================
Epoch 26/30
============================================================
Epoch 26/30 | Train Loss: 0.0023, Val Loss: 0.0970 | Train Acc#: 0.9998, Val Acc#: 0.9808 | No improvement: 14/30

============================================================
Epoch 27/30
============================================================
Epoch 27/30 | Train Loss: 0.0032, Val Loss: 0.1006 | Train Acc#: 0.9994, Val Acc#: 0.9791 | No improvement: 15/30

============================================================
Epoch 28/30
============================================================
Epoch 28/30 | Train Loss: 0.0026, Val Loss: 0.0994 | Train Acc#: 0.9996, Val Acc#: 0.9791 | No improvement: 16/30

============================================================
Epoch 29/30
============================================================
Epoch 29/30 | Train Loss: 0.0022, Val Loss: 0.0977 | Train Acc#: 0.9996, Val Acc#: 0.9791 | No improvement: 17/30

============================================================
Epoch 30/30
============================================================
Learning rate: 0.000000
Epoch 30/30 | Train Loss: 0.0022, Val Loss: 0.1017 | Train Acc#: 0.9998, Val Acc#: 0.9808 | No improvement: 18/30

Evaluating on test set with best model...
Test Metrics:
  Loss: 0.1500
  Acc Number: 0.9742
  Acc Tens: 0.9931
  Acc Ones: 0.9759
