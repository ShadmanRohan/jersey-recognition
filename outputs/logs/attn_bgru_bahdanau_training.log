Starting training for attn_bgru_bahdanau model
Device: cuda, Epochs: 30, Batch size: 64
LR: 0.001, Warmup: 1 epochs, Grad clip: 1.0
Mixed precision: True
Early stopping: patience=30 epochs (based on val loss)

============================================================
Epoch 1/30
============================================================
Learning rate: 0.000001
Epoch 1/30 | Train Loss: 2.5331, Val Loss: 0.6816 | Train Acc#: 0.3950, Val Acc#: 0.7962
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.7962)

============================================================
Epoch 2/30
============================================================
Epoch 2/30 | Train Loss: 0.3393, Val Loss: 0.2334 | Train Acc#: 0.9123, Val Acc#: 0.9355
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9355)

============================================================
Epoch 3/30
============================================================
Epoch 3/30 | Train Loss: 0.1252, Val Loss: 0.1625 | Train Acc#: 0.9681, Val Acc#: 0.9547
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9547)

============================================================
Epoch 4/30
============================================================
Epoch 4/30 | Train Loss: 0.0707, Val Loss: 0.1419 | Train Acc#: 0.9835, Val Acc#: 0.9617
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9617)

============================================================
Epoch 5/30
============================================================
Learning rate: 0.000097
Epoch 5/30 | Train Loss: 0.0488, Val Loss: 0.1218 | Train Acc#: 0.9882, Val Acc#: 0.9669
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9669)

============================================================
Epoch 6/30
============================================================
Epoch 6/30 | Train Loss: 0.0428, Val Loss: 0.1286 | Train Acc#: 0.9876, Val Acc#: 0.9634 | No improvement: 1/30

============================================================
Epoch 7/30
============================================================
Epoch 7/30 | Train Loss: 0.0341, Val Loss: 0.1082 | Train Acc#: 0.9919, Val Acc#: 0.9704
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9704)

============================================================
Epoch 8/30
============================================================
Epoch 8/30 | Train Loss: 0.0168, Val Loss: 0.0871 | Train Acc#: 0.9962, Val Acc#: 0.9774
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9774)

============================================================
Epoch 9/30
============================================================
Epoch 9/30 | Train Loss: 0.0168, Val Loss: 0.0766 | Train Acc#: 0.9957, Val Acc#: 0.9774

============================================================
Epoch 10/30
============================================================
Learning rate: 0.000082
Epoch 10/30 | Train Loss: 0.0106, Val Loss: 0.0781 | Train Acc#: 0.9974, Val Acc#: 0.9791 | No improvement: 1/30
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9791)

============================================================
Epoch 11/30
============================================================
Epoch 11/30 | Train Loss: 0.0068, Val Loss: 0.0762 | Train Acc#: 0.9976, Val Acc#: 0.9791

============================================================
Epoch 12/30
============================================================
Epoch 12/30 | Train Loss: 0.0093, Val Loss: 0.0655 | Train Acc#: 0.9972, Val Acc#: 0.9843
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9843)

============================================================
Epoch 13/30
============================================================
Epoch 13/30 | Train Loss: 0.0074, Val Loss: 0.0474 | Train Acc#: 0.9981, Val Acc#: 0.9895
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9895)

============================================================
Epoch 14/30
============================================================
Epoch 14/30 | Train Loss: 0.0057, Val Loss: 0.0658 | Train Acc#: 0.9983, Val Acc#: 0.9826 | No improvement: 1/30

============================================================
Epoch 15/30
============================================================
Learning rate: 0.000058
Epoch 15/30 | Train Loss: 0.0058, Val Loss: 0.0760 | Train Acc#: 0.9983, Val Acc#: 0.9791 | No improvement: 2/30

============================================================
Epoch 16/30
============================================================
Epoch 16/30 | Train Loss: 0.0042, Val Loss: 0.1120 | Train Acc#: 0.9983, Val Acc#: 0.9721 | No improvement: 3/30

============================================================
Epoch 17/30
============================================================
Epoch 17/30 | Train Loss: 0.0064, Val Loss: 0.0846 | Train Acc#: 0.9987, Val Acc#: 0.9826 | No improvement: 4/30

============================================================
Epoch 18/30
============================================================
Epoch 18/30 | Train Loss: 0.0015, Val Loss: 0.0869 | Train Acc#: 0.9998, Val Acc#: 0.9826 | No improvement: 5/30

============================================================
Epoch 19/30
============================================================
Epoch 19/30 | Train Loss: 0.0030, Val Loss: 0.0805 | Train Acc#: 0.9991, Val Acc#: 0.9826 | No improvement: 6/30

============================================================
Epoch 20/30
============================================================
Learning rate: 0.000031
Epoch 20/30 | Train Loss: 0.0022, Val Loss: 0.0827 | Train Acc#: 0.9994, Val Acc#: 0.9843 | No improvement: 7/30

============================================================
Epoch 21/30
============================================================
Epoch 21/30 | Train Loss: 0.0025, Val Loss: 0.0744 | Train Acc#: 0.9994, Val Acc#: 0.9895 | No improvement: 8/30

============================================================
Epoch 22/30
============================================================
Epoch 22/30 | Train Loss: 0.0014, Val Loss: 0.0748 | Train Acc#: 0.9994, Val Acc#: 0.9878 | No improvement: 9/30

============================================================
Epoch 23/30
============================================================
Epoch 23/30 | Train Loss: 0.0020, Val Loss: 0.0710 | Train Acc#: 0.9991, Val Acc#: 0.9878 | No improvement: 10/30

============================================================
Epoch 24/30
============================================================
Epoch 24/30 | Train Loss: 0.0010, Val Loss: 0.0622 | Train Acc#: 0.9998, Val Acc#: 0.9895 | No improvement: 11/30

============================================================
Epoch 25/30
============================================================
Learning rate: 0.000010
Epoch 25/30 | Train Loss: 0.0010, Val Loss: 0.0554 | Train Acc#: 0.9998, Val Acc#: 0.9913 | No improvement: 12/30
Saved best checkpoint: outputs/checkpoints/attn_bgru_bahdanau_best.pth (Val Acc: 0.9913)

============================================================
Epoch 26/30
============================================================
Epoch 26/30 | Train Loss: 0.0036, Val Loss: 0.0602 | Train Acc#: 0.9994, Val Acc#: 0.9895 | No improvement: 13/30

============================================================
Epoch 27/30
============================================================
Epoch 27/30 | Train Loss: 0.0010, Val Loss: 0.0621 | Train Acc#: 0.9998, Val Acc#: 0.9895 | No improvement: 14/30

============================================================
Epoch 28/30
============================================================
Epoch 28/30 | Train Loss: 0.0011, Val Loss: 0.0699 | Train Acc#: 0.9998, Val Acc#: 0.9878 | No improvement: 15/30

============================================================
Epoch 29/30
============================================================
Epoch 29/30 | Train Loss: 0.0017, Val Loss: 0.0624 | Train Acc#: 0.9996, Val Acc#: 0.9895 | No improvement: 16/30

============================================================
Epoch 30/30
============================================================
Learning rate: 0.000000
Epoch 30/30 | Train Loss: 0.0012, Val Loss: 0.0729 | Train Acc#: 0.9994, Val Acc#: 0.9861 | No improvement: 17/30

Evaluating on test set with best model...
Test Metrics:
  Loss: 0.1257
  Acc Number: 0.9777
  Acc Tens: 0.9948
  Acc Ones: 0.9794
