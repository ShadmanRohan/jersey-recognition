Starting training for attn_bgru_gate model
Device: cuda, Epochs: 30, Batch size: 64
LR: 0.001, Warmup: 1 epochs, Grad clip: 1.0
Mixed precision: True
Early stopping: patience=30 epochs (based on val loss)

============================================================
Epoch 1/30
============================================================
Learning rate: 0.000001
Epoch 1/30 | Train Loss: 2.9286, Val Loss: 1.6192 | Train Acc#: 0.2838, Val Acc#: 0.4739
Saved best checkpoint: outputs/checkpoints/attn_bgru_gate_best.pth (Val Acc: 0.4739)

============================================================
Epoch 2/30
============================================================
Epoch 2/30 | Train Loss: 1.2272, Val Loss: 0.9564 | Train Acc#: 0.6300, Val Acc#: 0.7822
Saved best checkpoint: outputs/checkpoints/attn_bgru_gate_best.pth (Val Acc: 0.7822)

============================================================
Epoch 3/30
============================================================
Epoch 3/30 | Train Loss: 0.7663, Val Loss: 0.6944 | Train Acc#: 0.8323, Val Acc#: 0.8554
Saved best checkpoint: outputs/checkpoints/attn_bgru_gate_best.pth (Val Acc: 0.8554)

============================================================
Epoch 4/30
============================================================
Epoch 4/30 | Train Loss: 0.5808, Val Loss: 0.6640 | Train Acc#: 0.8892, Val Acc#: 0.8432

============================================================
Epoch 5/30
============================================================
Learning rate: 0.000097
Epoch 5/30 | Train Loss: 0.4747, Val Loss: 0.5482 | Train Acc#: 0.9095, Val Acc#: 0.9042
Saved best checkpoint: outputs/checkpoints/attn_bgru_gate_best.pth (Val Acc: 0.9042)

============================================================
Epoch 6/30
============================================================
Epoch 6/30 | Train Loss: 0.4237, Val Loss: 0.5434 | Train Acc#: 0.9249, Val Acc#: 0.9007

============================================================
Epoch 7/30
============================================================
Epoch 7/30 | Train Loss: 0.4093, Val Loss: 0.6113 | Train Acc#: 0.9284, Val Acc#: 0.8554 | No improvement: 1/30

============================================================
Epoch 8/30
============================================================
Epoch 8/30 | Train Loss: 0.3939, Val Loss: 0.6030 | Train Acc#: 0.9314, Val Acc#: 0.8606 | No improvement: 2/30

============================================================
Epoch 9/30
============================================================
Epoch 9/30 | Train Loss: 0.3693, Val Loss: 0.3829 | Train Acc#: 0.9337, Val Acc#: 0.9355
Saved best checkpoint: outputs/checkpoints/attn_bgru_gate_best.pth (Val Acc: 0.9355)

============================================================
Epoch 10/30
============================================================
Learning rate: 0.000082
Epoch 10/30 | Train Loss: 0.3538, Val Loss: 0.4133 | Train Acc#: 0.9262, Val Acc#: 0.9024 | No improvement: 1/30

============================================================
Epoch 11/30
============================================================
Epoch 11/30 | Train Loss: 0.2923, Val Loss: 0.2993 | Train Acc#: 0.9356, Val Acc#: 0.9268

============================================================
Epoch 12/30
============================================================
Epoch 12/30 | Train Loss: 0.2549, Val Loss: 0.4350 | Train Acc#: 0.9459, Val Acc#: 0.8798 | No improvement: 1/30

============================================================
Epoch 13/30
============================================================
Epoch 13/30 | Train Loss: 0.2372, Val Loss: 0.2420 | Train Acc#: 0.9489, Val Acc#: 0.9477
Saved best checkpoint: outputs/checkpoints/attn_bgru_gate_best.pth (Val Acc: 0.9477)

============================================================
Epoch 14/30
============================================================
Epoch 14/30 | Train Loss: 0.2181, Val Loss: 0.2584 | Train Acc#: 0.9519, Val Acc#: 0.9425 | No improvement: 1/30

============================================================
Epoch 15/30
============================================================
Learning rate: 0.000058
Epoch 15/30 | Train Loss: 0.2012, Val Loss: 0.2838 | Train Acc#: 0.9581, Val Acc#: 0.9321 | No improvement: 2/30

============================================================
Epoch 16/30
============================================================
Epoch 16/30 | Train Loss: 0.1966, Val Loss: 0.2541 | Train Acc#: 0.9596, Val Acc#: 0.9425 | No improvement: 3/30

============================================================
Epoch 17/30
============================================================
Epoch 17/30 | Train Loss: 0.1568, Val Loss: 0.2147 | Train Acc#: 0.9707, Val Acc#: 0.9477

============================================================
Epoch 18/30
============================================================
Epoch 18/30 | Train Loss: 0.1490, Val Loss: 0.2458 | Train Acc#: 0.9705, Val Acc#: 0.9443 | No improvement: 1/30

============================================================
Epoch 19/30
============================================================
Epoch 19/30 | Train Loss: nan, Val Loss: nan | Train Acc#: 0.0137, Val Acc#: 0.0000 | No improvement: 2/30

============================================================
Epoch 20/30
============================================================
Learning rate: 0.000031
Epoch 20/30 | Train Loss: nan, Val Loss: nan | Train Acc#: 0.0000, Val Acc#: 0.0000 | No improvement: 3/30

============================================================
Epoch 21/30
============================================================
Epoch 21/30 | Train Loss: nan, Val Loss: nan | Train Acc#: 0.0000, Val Acc#: 0.0000 | No improvement: 4/30

============================================================
Epoch 22/30
============================================================
Epoch 22/30 | Train Loss: nan, Val Loss: nan | Train Acc#: 0.0000, Val Acc#: 0.0000 | No improvement: 5/30

============================================================
Epoch 23/30
============================================================
Epoch 23/30 | Train Loss: nan, Val Loss: nan | Train Acc#: 0.0000, Val Acc#: 0.0000 | No improvement: 6/30

============================================================
Epoch 24/30
============================================================
Epoch 24/30 | Train Loss: nan, Val Loss: nan | Train Acc#: 0.0000, Val Acc#: 0.0000 | No improvement: 7/30

============================================================
Epoch 25/30
============================================================
Learning rate: 0.000010
Epoch 25/30 | Train Loss: nan, Val Loss: nan | Train Acc#: 0.0000, Val Acc#: 0.0000 | No improvement: 8/30

============================================================
Epoch 26/30
============================================================
Epoch 26/30 | Train Loss: nan, Val Loss: nan | Train Acc#: 0.0000, Val Acc#: 0.0000 | No improvement: 9/30

============================================================
Epoch 27/30
============================================================
Epoch 27/30 | Train Loss: nan, Val Loss: nan | Train Acc#: 0.0000, Val Acc#: 0.0000 | No improvement: 10/30

============================================================
Epoch 28/30
============================================================
Epoch 28/30 | Train Loss: nan, Val Loss: nan | Train Acc#: 0.0000, Val Acc#: 0.0000 | No improvement: 11/30

============================================================
Epoch 29/30
============================================================
Epoch 29/30 | Train Loss: nan, Val Loss: nan | Train Acc#: 0.0000, Val Acc#: 0.0000 | No improvement: 12/30

============================================================
Epoch 30/30
============================================================
Learning rate: 0.000000
Epoch 30/30 | Train Loss: nan, Val Loss: nan | Train Acc#: 0.0000, Val Acc#: 0.0000 | No improvement: 13/30

Evaluating on test set with best model...
Test Metrics:
  Loss: 0.2852
  Acc Number: 0.9227
  Acc Tens: 0.9742
  Acc Ones: 0.9450
