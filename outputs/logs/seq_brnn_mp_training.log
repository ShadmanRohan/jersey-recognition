Starting training for seq_brnn_mp model
Device: cuda, Epochs: 30, Batch size: 64
LR: 0.001, Warmup: 1 epochs, Grad clip: 1.0
Mixed precision: True
Early stopping: patience=30 epochs (based on val loss)

============================================================
Epoch 1/30
============================================================
Learning rate: 0.000001
Epoch 1/30 | Train Loss: 2.1974, Val Loss: 0.6719 | Train Acc#: 0.4311, Val Acc#: 0.7700
Saved best checkpoint: outputs/checkpoints/seq_brnn_mp_best.pth (Val Acc: 0.7700)

============================================================
Epoch 2/30
============================================================
Epoch 2/30 | Train Loss: 0.3105, Val Loss: 0.2015 | Train Acc#: 0.9202, Val Acc#: 0.9530
Saved best checkpoint: outputs/checkpoints/seq_brnn_mp_best.pth (Val Acc: 0.9530)

============================================================
Epoch 3/30
============================================================
Epoch 3/30 | Train Loss: 0.1219, Val Loss: 0.1173 | Train Acc#: 0.9722, Val Acc#: 0.9669
Saved best checkpoint: outputs/checkpoints/seq_brnn_mp_best.pth (Val Acc: 0.9669)

============================================================
Epoch 4/30
============================================================
Epoch 4/30 | Train Loss: 0.0592, Val Loss: 0.1875 | Train Acc#: 0.9844, Val Acc#: 0.9547 | No improvement: 1/30

============================================================
Epoch 5/30
============================================================
Learning rate: 0.000097
Epoch 5/30 | Train Loss: 0.0404, Val Loss: 0.0956 | Train Acc#: 0.9904, Val Acc#: 0.9756
Saved best checkpoint: outputs/checkpoints/seq_brnn_mp_best.pth (Val Acc: 0.9756)

============================================================
Epoch 6/30
============================================================
Epoch 6/30 | Train Loss: 0.0311, Val Loss: 0.1106 | Train Acc#: 0.9923, Val Acc#: 0.9634 | No improvement: 1/30

============================================================
Epoch 7/30
============================================================
Epoch 7/30 | Train Loss: 0.0225, Val Loss: 0.1482 | Train Acc#: 0.9934, Val Acc#: 0.9634 | No improvement: 2/30

============================================================
Epoch 8/30
============================================================
Epoch 8/30 | Train Loss: 0.0166, Val Loss: 0.0693 | Train Acc#: 0.9951, Val Acc#: 0.9826
Saved best checkpoint: outputs/checkpoints/seq_brnn_mp_best.pth (Val Acc: 0.9826)

============================================================
Epoch 9/30
============================================================
Epoch 9/30 | Train Loss: 0.0102, Val Loss: 0.0814 | Train Acc#: 0.9970, Val Acc#: 0.9739 | No improvement: 1/30

============================================================
Epoch 10/30
============================================================
Learning rate: 0.000082
Epoch 10/30 | Train Loss: 0.0085, Val Loss: 0.0698 | Train Acc#: 0.9985, Val Acc#: 0.9843 | No improvement: 2/30
Saved best checkpoint: outputs/checkpoints/seq_brnn_mp_best.pth (Val Acc: 0.9843)

============================================================
Epoch 11/30
============================================================
Epoch 11/30 | Train Loss: 0.0050, Val Loss: 0.0831 | Train Acc#: 0.9994, Val Acc#: 0.9791 | No improvement: 3/30

============================================================
Epoch 12/30
============================================================
Epoch 12/30 | Train Loss: 0.0091, Val Loss: 0.0793 | Train Acc#: 0.9979, Val Acc#: 0.9861 | No improvement: 4/30
Saved best checkpoint: outputs/checkpoints/seq_brnn_mp_best.pth (Val Acc: 0.9861)

============================================================
Epoch 13/30
============================================================
Epoch 13/30 | Train Loss: 0.0067, Val Loss: 0.0791 | Train Acc#: 0.9983, Val Acc#: 0.9843 | No improvement: 5/30

============================================================
Epoch 14/30
============================================================
Epoch 14/30 | Train Loss: 0.0052, Val Loss: 0.0704 | Train Acc#: 0.9985, Val Acc#: 0.9826 | No improvement: 6/30

============================================================
Epoch 15/30
============================================================
Learning rate: 0.000058
Epoch 15/30 | Train Loss: 0.0027, Val Loss: 0.0621 | Train Acc#: 0.9987, Val Acc#: 0.9861

============================================================
Epoch 16/30
============================================================
Epoch 16/30 | Train Loss: 0.0019, Val Loss: 0.0594 | Train Acc#: 0.9998, Val Acc#: 0.9843

============================================================
Epoch 17/30
============================================================
Epoch 17/30 | Train Loss: 0.0016, Val Loss: 0.0558 | Train Acc#: 0.9991, Val Acc#: 0.9913
Saved best checkpoint: outputs/checkpoints/seq_brnn_mp_best.pth (Val Acc: 0.9913)

============================================================
Epoch 18/30
============================================================
Epoch 18/30 | Train Loss: 0.0013, Val Loss: 0.0639 | Train Acc#: 0.9998, Val Acc#: 0.9878 | No improvement: 1/30

============================================================
Epoch 19/30
============================================================
Epoch 19/30 | Train Loss: 0.0018, Val Loss: 0.0725 | Train Acc#: 0.9996, Val Acc#: 0.9843 | No improvement: 2/30

============================================================
Epoch 20/30
============================================================
Learning rate: 0.000031
Epoch 20/30 | Train Loss: 0.0030, Val Loss: 0.0751 | Train Acc#: 0.9994, Val Acc#: 0.9843 | No improvement: 3/30

============================================================
Epoch 21/30
============================================================
Epoch 21/30 | Train Loss: 0.0017, Val Loss: 0.0870 | Train Acc#: 0.9996, Val Acc#: 0.9808 | No improvement: 4/30

============================================================
Epoch 22/30
============================================================
Epoch 22/30 | Train Loss: 0.0013, Val Loss: 0.0809 | Train Acc#: 0.9994, Val Acc#: 0.9843 | No improvement: 5/30

============================================================
Epoch 23/30
============================================================
Epoch 23/30 | Train Loss: 0.0009, Val Loss: 0.0670 | Train Acc#: 1.0000, Val Acc#: 0.9861 | No improvement: 6/30

============================================================
Epoch 24/30
============================================================
Epoch 24/30 | Train Loss: 0.0009, Val Loss: 0.0746 | Train Acc#: 0.9996, Val Acc#: 0.9861 | No improvement: 7/30

============================================================
Epoch 25/30
============================================================
Learning rate: 0.000010
Epoch 25/30 | Train Loss: 0.0013, Val Loss: 0.0781 | Train Acc#: 0.9994, Val Acc#: 0.9826 | No improvement: 8/30

============================================================
Epoch 26/30
============================================================
Epoch 26/30 | Train Loss: 0.0009, Val Loss: 0.0793 | Train Acc#: 0.9998, Val Acc#: 0.9826 | No improvement: 9/30

============================================================
Epoch 27/30
============================================================
Epoch 27/30 | Train Loss: 0.0008, Val Loss: 0.0764 | Train Acc#: 1.0000, Val Acc#: 0.9826 | No improvement: 10/30

============================================================
Epoch 28/30
============================================================
Epoch 28/30 | Train Loss: 0.0010, Val Loss: 0.0761 | Train Acc#: 0.9998, Val Acc#: 0.9826 | No improvement: 11/30

============================================================
Epoch 29/30
============================================================
Epoch 29/30 | Train Loss: 0.0010, Val Loss: 0.0679 | Train Acc#: 0.9996, Val Acc#: 0.9895 | No improvement: 12/30

============================================================
Epoch 30/30
============================================================
Learning rate: 0.000000
Epoch 30/30 | Train Loss: 0.0011, Val Loss: 0.0745 | Train Acc#: 0.9996, Val Acc#: 0.9826 | No improvement: 13/30

Evaluating on test set with best model...
Test Metrics:
  Loss: 0.1271
  Acc Number: 0.9777
  Acc Tens: 0.9966
  Acc Ones: 0.9794
