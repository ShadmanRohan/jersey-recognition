Starting training for seq_ugru_fs model
Device: cuda, Epochs: 30, Batch size: 64
LR: 0.001, Warmup: 1 epochs, Grad clip: 1.0
Mixed precision: True
Early stopping: patience=30 epochs (based on val loss)

============================================================
Epoch 1/30
============================================================
Learning rate: 0.000001
Epoch 1/30 | Train Loss: 3.1044, Val Loss: 1.1828 | Train Acc#: 0.2870, Val Acc#: 0.5679
Saved best checkpoint: outputs/checkpoints/seq_ugru_fs_best.pth (Val Acc: 0.5679)

============================================================
Epoch 2/30
============================================================
Epoch 2/30 | Train Loss: 0.6776, Val Loss: 0.3907 | Train Acc#: 0.8152, Val Acc#: 0.9129
Saved best checkpoint: outputs/checkpoints/seq_ugru_fs_best.pth (Val Acc: 0.9129)

============================================================
Epoch 3/30
============================================================
Epoch 3/30 | Train Loss: 0.2379, Val Loss: 0.2643 | Train Acc#: 0.9532, Val Acc#: 0.9321
Saved best checkpoint: outputs/checkpoints/seq_ugru_fs_best.pth (Val Acc: 0.9321)

============================================================
Epoch 4/30
============================================================
Epoch 4/30 | Train Loss: 0.1194, Val Loss: 0.1730 | Train Acc#: 0.9786, Val Acc#: 0.9530
Saved best checkpoint: outputs/checkpoints/seq_ugru_fs_best.pth (Val Acc: 0.9530)

============================================================
Epoch 5/30
============================================================
Learning rate: 0.000097
Epoch 5/30 | Train Loss: 0.0768, Val Loss: 0.2223 | Train Acc#: 0.9857, Val Acc#: 0.9321 | No improvement: 1/30

============================================================
Epoch 6/30
============================================================
Epoch 6/30 | Train Loss: 0.0584, Val Loss: 0.1471 | Train Acc#: 0.9865, Val Acc#: 0.9617
Saved best checkpoint: outputs/checkpoints/seq_ugru_fs_best.pth (Val Acc: 0.9617)

============================================================
Epoch 7/30
============================================================
Epoch 7/30 | Train Loss: 0.0324, Val Loss: 0.1274 | Train Acc#: 0.9936, Val Acc#: 0.9686
Saved best checkpoint: outputs/checkpoints/seq_ugru_fs_best.pth (Val Acc: 0.9686)

============================================================
Epoch 8/30
============================================================
Epoch 8/30 | Train Loss: 0.0275, Val Loss: 0.1478 | Train Acc#: 0.9955, Val Acc#: 0.9617 | No improvement: 1/30

============================================================
Epoch 9/30
============================================================
Epoch 9/30 | Train Loss: 0.0236, Val Loss: 0.0926 | Train Acc#: 0.9953, Val Acc#: 0.9739
Saved best checkpoint: outputs/checkpoints/seq_ugru_fs_best.pth (Val Acc: 0.9739)

============================================================
Epoch 10/30
============================================================
Learning rate: 0.000082
Epoch 10/30 | Train Loss: 0.0198, Val Loss: 0.1008 | Train Acc#: 0.9959, Val Acc#: 0.9739 | No improvement: 1/30

============================================================
Epoch 11/30
============================================================
Epoch 11/30 | Train Loss: 0.0140, Val Loss: 0.1020 | Train Acc#: 0.9972, Val Acc#: 0.9704 | No improvement: 2/30

============================================================
Epoch 12/30
============================================================
Epoch 12/30 | Train Loss: 0.0140, Val Loss: 0.1070 | Train Acc#: 0.9964, Val Acc#: 0.9774 | No improvement: 3/30
Saved best checkpoint: outputs/checkpoints/seq_ugru_fs_best.pth (Val Acc: 0.9774)

============================================================
Epoch 13/30
============================================================
Epoch 13/30 | Train Loss: 0.0138, Val Loss: 0.1248 | Train Acc#: 0.9979, Val Acc#: 0.9686 | No improvement: 4/30

============================================================
Epoch 14/30
============================================================
Epoch 14/30 | Train Loss: 0.0079, Val Loss: 0.1226 | Train Acc#: 0.9991, Val Acc#: 0.9756 | No improvement: 5/30

============================================================
Epoch 15/30
============================================================
Learning rate: 0.000058
Epoch 15/30 | Train Loss: 0.0075, Val Loss: 0.1064 | Train Acc#: 0.9985, Val Acc#: 0.9774 | No improvement: 6/30

============================================================
Epoch 16/30
============================================================
Epoch 16/30 | Train Loss: 0.0071, Val Loss: 0.1075 | Train Acc#: 0.9985, Val Acc#: 0.9704 | No improvement: 7/30

============================================================
Epoch 17/30
============================================================
Epoch 17/30 | Train Loss: 0.0043, Val Loss: 0.1301 | Train Acc#: 0.9996, Val Acc#: 0.9721 | No improvement: 8/30

============================================================
Epoch 18/30
============================================================
Epoch 18/30 | Train Loss: 0.0043, Val Loss: 0.1500 | Train Acc#: 0.9991, Val Acc#: 0.9686 | No improvement: 9/30

============================================================
Epoch 19/30
============================================================
Epoch 19/30 | Train Loss: 0.0039, Val Loss: 0.1358 | Train Acc#: 0.9991, Val Acc#: 0.9669 | No improvement: 10/30

============================================================
Epoch 20/30
============================================================
Learning rate: 0.000031
Epoch 20/30 | Train Loss: 0.0031, Val Loss: 0.1319 | Train Acc#: 0.9994, Val Acc#: 0.9739 | No improvement: 11/30

============================================================
Epoch 21/30
============================================================
Epoch 21/30 | Train Loss: 0.0029, Val Loss: 0.1175 | Train Acc#: 0.9994, Val Acc#: 0.9721 | No improvement: 12/30

============================================================
Epoch 22/30
============================================================
Epoch 22/30 | Train Loss: 0.0023, Val Loss: 0.1163 | Train Acc#: 0.9998, Val Acc#: 0.9756 | No improvement: 13/30

============================================================
Epoch 23/30
============================================================
Epoch 23/30 | Train Loss: 0.0023, Val Loss: 0.1184 | Train Acc#: 0.9998, Val Acc#: 0.9774 | No improvement: 14/30

============================================================
Epoch 24/30
============================================================
Epoch 24/30 | Train Loss: 0.0021, Val Loss: 0.1205 | Train Acc#: 0.9998, Val Acc#: 0.9756 | No improvement: 15/30

============================================================
Epoch 25/30
============================================================
Learning rate: 0.000010
Epoch 25/30 | Train Loss: 0.0020, Val Loss: 0.1216 | Train Acc#: 0.9998, Val Acc#: 0.9756 | No improvement: 16/30

============================================================
Epoch 26/30
============================================================
Epoch 26/30 | Train Loss: 0.0021, Val Loss: 0.1135 | Train Acc#: 0.9998, Val Acc#: 0.9791 | No improvement: 17/30
Saved best checkpoint: outputs/checkpoints/seq_ugru_fs_best.pth (Val Acc: 0.9791)

============================================================
Epoch 27/30
============================================================
Epoch 27/30 | Train Loss: 0.0020, Val Loss: 0.1267 | Train Acc#: 1.0000, Val Acc#: 0.9739 | No improvement: 18/30

============================================================
Epoch 28/30
============================================================
Epoch 28/30 | Train Loss: 0.0021, Val Loss: 0.1150 | Train Acc#: 0.9998, Val Acc#: 0.9721 | No improvement: 19/30

============================================================
Epoch 29/30
============================================================
Epoch 29/30 | Train Loss: 0.0020, Val Loss: 0.1127 | Train Acc#: 0.9998, Val Acc#: 0.9774 | No improvement: 20/30

============================================================
Epoch 30/30
============================================================
Learning rate: 0.000000
Epoch 30/30 | Train Loss: 0.0021, Val Loss: 0.1170 | Train Acc#: 0.9998, Val Acc#: 0.9756 | No improvement: 21/30

Evaluating on test set with best model...
Test Metrics:
  Loss: 0.1599
  Acc Number: 0.9725
  Acc Tens: 0.9948
  Acc Ones: 0.9742
