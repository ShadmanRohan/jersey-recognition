Starting training for basic_effl0 model
Device: cuda, Epochs: 30, Batch size: 64
LR: 0.001, Warmup: 1 epochs, Grad clip: 1.0
Mixed precision: True
Early stopping: patience=30 epochs (based on val loss)

============================================================
Epoch 1/30
============================================================
Learning rate: 0.000014
Epoch 1/30 | Train Loss: 2.1662, Val Loss: 0.7940 | Train Acc#: 0.4228, Val Acc#: 0.7387
Saved best checkpoint: outputs/checkpoints/basic_effl0_best.pth (Val Acc: 0.7387)

============================================================
Epoch 2/30
============================================================
Epoch 2/30 | Train Loss: 0.5513, Val Loss: 0.4280 | Train Acc#: 0.8148, Val Acc#: 0.8815
Saved best checkpoint: outputs/checkpoints/basic_effl0_best.pth (Val Acc: 0.8815)

============================================================
Epoch 3/30
============================================================
Epoch 3/30 | Train Loss: 0.3071, Val Loss: 0.3747 | Train Acc#: 0.9036, Val Acc#: 0.8885
Saved best checkpoint: outputs/checkpoints/basic_effl0_best.pth (Val Acc: 0.8885)

============================================================
Epoch 4/30
============================================================
Epoch 4/30 | Train Loss: 0.2372, Val Loss: 0.3496 | Train Acc#: 0.9234, Val Acc#: 0.9024
Saved best checkpoint: outputs/checkpoints/basic_effl0_best.pth (Val Acc: 0.9024)

============================================================
Epoch 5/30
============================================================
Learning rate: 0.000974
Epoch 5/30 | Train Loss: 0.1713, Val Loss: 0.3115 | Train Acc#: 0.9455, Val Acc#: 0.9181
Saved best checkpoint: outputs/checkpoints/basic_effl0_best.pth (Val Acc: 0.9181)

============================================================
Epoch 6/30
============================================================
Epoch 6/30 | Train Loss: 0.1371, Val Loss: 0.2829 | Train Acc#: 0.9559, Val Acc#: 0.9390
Saved best checkpoint: outputs/checkpoints/basic_effl0_best.pth (Val Acc: 0.9390)

============================================================
Epoch 7/30
============================================================
Epoch 7/30 | Train Loss: 0.1422, Val Loss: 0.3020 | Train Acc#: 0.9579, Val Acc#: 0.9286 | No improvement: 1/30

============================================================
Epoch 8/30
============================================================
Epoch 8/30 | Train Loss: 0.1079, Val Loss: 0.3062 | Train Acc#: 0.9669, Val Acc#: 0.9390 | No improvement: 2/30

============================================================
Epoch 9/30
============================================================
Epoch 9/30 | Train Loss: 0.0831, Val Loss: 0.2567 | Train Acc#: 0.9771, Val Acc#: 0.9460
Saved best checkpoint: outputs/checkpoints/basic_effl0_best.pth (Val Acc: 0.9460)

============================================================
Epoch 10/30
============================================================
Learning rate: 0.000824
Epoch 10/30 | Train Loss: 0.0613, Val Loss: 0.2842 | Train Acc#: 0.9797, Val Acc#: 0.9390 | No improvement: 1/30

============================================================
Epoch 11/30
============================================================
Epoch 11/30 | Train Loss: 0.0596, Val Loss: 0.3068 | Train Acc#: 0.9814, Val Acc#: 0.9338 | No improvement: 2/30

============================================================
Epoch 12/30
============================================================
Epoch 12/30 | Train Loss: 0.0348, Val Loss: 0.2729 | Train Acc#: 0.9885, Val Acc#: 0.9373 | No improvement: 3/30

============================================================
Epoch 13/30
============================================================
Epoch 13/30 | Train Loss: 0.0422, Val Loss: 0.2649 | Train Acc#: 0.9867, Val Acc#: 0.9477 | No improvement: 4/30
Saved best checkpoint: outputs/checkpoints/basic_effl0_best.pth (Val Acc: 0.9477)

============================================================
Epoch 14/30
============================================================
Epoch 14/30 | Train Loss: 0.0321, Val Loss: 0.2227 | Train Acc#: 0.9906, Val Acc#: 0.9495
Saved best checkpoint: outputs/checkpoints/basic_effl0_best.pth (Val Acc: 0.9495)

============================================================
Epoch 15/30
============================================================
Learning rate: 0.000581
Epoch 15/30 | Train Loss: 0.0243, Val Loss: 0.2297 | Train Acc#: 0.9927, Val Acc#: 0.9477 | No improvement: 1/30

============================================================
Epoch 16/30
============================================================
Epoch 16/30 | Train Loss: 0.0171, Val Loss: 0.1817 | Train Acc#: 0.9955, Val Acc#: 0.9547
Saved best checkpoint: outputs/checkpoints/basic_effl0_best.pth (Val Acc: 0.9547)

============================================================
Epoch 17/30
============================================================
Epoch 17/30 | Train Loss: 0.0159, Val Loss: 0.2357 | Train Acc#: 0.9955, Val Acc#: 0.9599 | No improvement: 1/30
Saved best checkpoint: outputs/checkpoints/basic_effl0_best.pth (Val Acc: 0.9599)

============================================================
Epoch 18/30
============================================================
Epoch 18/30 | Train Loss: 0.0119, Val Loss: 0.2286 | Train Acc#: 0.9957, Val Acc#: 0.9634 | No improvement: 2/30
Saved best checkpoint: outputs/checkpoints/basic_effl0_best.pth (Val Acc: 0.9634)

============================================================
Epoch 19/30
============================================================
Epoch 19/30 | Train Loss: 0.0177, Val Loss: 0.2165 | Train Acc#: 0.9955, Val Acc#: 0.9582 | No improvement: 3/30

============================================================
Epoch 20/30
============================================================
Learning rate: 0.000315
Epoch 20/30 | Train Loss: 0.0081, Val Loss: 0.2256 | Train Acc#: 0.9968, Val Acc#: 0.9617 | No improvement: 4/30

============================================================
Epoch 21/30
============================================================
Epoch 21/30 | Train Loss: 0.0103, Val Loss: 0.1769 | Train Acc#: 0.9974, Val Acc#: 0.9669
Saved best checkpoint: outputs/checkpoints/basic_effl0_best.pth (Val Acc: 0.9669)

============================================================
Epoch 22/30
============================================================
Epoch 22/30 | Train Loss: 0.0030, Val Loss: 0.2189 | Train Acc#: 0.9987, Val Acc#: 0.9512 | No improvement: 1/30

============================================================
Epoch 23/30
============================================================
Epoch 23/30 | Train Loss: 0.0055, Val Loss: 0.2312 | Train Acc#: 0.9983, Val Acc#: 0.9547 | No improvement: 2/30

============================================================
Epoch 24/30
============================================================
Epoch 24/30 | Train Loss: 0.0067, Val Loss: 0.2145 | Train Acc#: 0.9979, Val Acc#: 0.9599 | No improvement: 3/30

============================================================
Epoch 25/30
============================================================
Learning rate: 0.000102
Epoch 25/30 | Train Loss: 0.0035, Val Loss: 0.2024 | Train Acc#: 0.9987, Val Acc#: 0.9634 | No improvement: 4/30

============================================================
Epoch 26/30
============================================================
Epoch 26/30 | Train Loss: 0.0032, Val Loss: 0.2016 | Train Acc#: 0.9989, Val Acc#: 0.9652 | No improvement: 5/30

============================================================
Epoch 27/30
============================================================
Epoch 27/30 | Train Loss: 0.0019, Val Loss: 0.2104 | Train Acc#: 0.9996, Val Acc#: 0.9652 | No improvement: 6/30

============================================================
Epoch 28/30
============================================================
Epoch 28/30 | Train Loss: 0.0029, Val Loss: 0.1985 | Train Acc#: 0.9989, Val Acc#: 0.9617 | No improvement: 7/30

============================================================
Epoch 29/30
============================================================
Epoch 29/30 | Train Loss: 0.0021, Val Loss: 0.2051 | Train Acc#: 0.9996, Val Acc#: 0.9617 | No improvement: 8/30

============================================================
Epoch 30/30
============================================================
Learning rate: 0.000003
Epoch 30/30 | Train Loss: 0.0019, Val Loss: 0.2027 | Train Acc#: 0.9994, Val Acc#: 0.9669 | No improvement: 9/30

Evaluating on test set with best model...
Test Metrics:
  Loss: 0.1834
  Acc Number: 0.9639
  Acc Tens: 0.9914
  Acc Ones: 0.9674
