Starting training for seq_blstm_mp model
Device: cuda, Epochs: 30, Batch size: 64
LR: 0.001, Warmup: 1 epochs, Grad clip: 1.0
Mixed precision: True
Early stopping: patience=30 epochs (based on val loss)

============================================================
Epoch 1/30
============================================================
Learning rate: 0.000001
Epoch 1/30 | Train Loss: 2.5131, Val Loss: 0.8474 | Train Acc#: 0.3892, Val Acc#: 0.7387
Saved best checkpoint: outputs/checkpoints/seq_blstm_mp_best.pth (Val Acc: 0.7387)

============================================================
Epoch 2/30
============================================================
Epoch 2/30 | Train Loss: 0.4001, Val Loss: 0.2534 | Train Acc#: 0.8935, Val Acc#: 0.9286
Saved best checkpoint: outputs/checkpoints/seq_blstm_mp_best.pth (Val Acc: 0.9286)

============================================================
Epoch 3/30
============================================================
Epoch 3/30 | Train Loss: 0.1425, Val Loss: 0.1547 | Train Acc#: 0.9658, Val Acc#: 0.9599
Saved best checkpoint: outputs/checkpoints/seq_blstm_mp_best.pth (Val Acc: 0.9599)

============================================================
Epoch 4/30
============================================================
Epoch 4/30 | Train Loss: 0.0824, Val Loss: 0.1300 | Train Acc#: 0.9799, Val Acc#: 0.9617
Saved best checkpoint: outputs/checkpoints/seq_blstm_mp_best.pth (Val Acc: 0.9617)

============================================================
Epoch 5/30
============================================================
Learning rate: 0.000097
Epoch 5/30 | Train Loss: 0.0539, Val Loss: 0.1536 | Train Acc#: 0.9861, Val Acc#: 0.9547 | No improvement: 1/30

============================================================
Epoch 6/30
============================================================
Epoch 6/30 | Train Loss: 0.0460, Val Loss: 0.1182 | Train Acc#: 0.9880, Val Acc#: 0.9652
Saved best checkpoint: outputs/checkpoints/seq_blstm_mp_best.pth (Val Acc: 0.9652)

============================================================
Epoch 7/30
============================================================
Epoch 7/30 | Train Loss: 0.0244, Val Loss: 0.1780 | Train Acc#: 0.9951, Val Acc#: 0.9582 | No improvement: 1/30

============================================================
Epoch 8/30
============================================================
Epoch 8/30 | Train Loss: 0.0187, Val Loss: 0.0925 | Train Acc#: 0.9957, Val Acc#: 0.9756
Saved best checkpoint: outputs/checkpoints/seq_blstm_mp_best.pth (Val Acc: 0.9756)

============================================================
Epoch 9/30
============================================================
Epoch 9/30 | Train Loss: 0.0176, Val Loss: 0.1468 | Train Acc#: 0.9951, Val Acc#: 0.9686 | No improvement: 1/30

============================================================
Epoch 10/30
============================================================
Learning rate: 0.000082
Epoch 10/30 | Train Loss: 0.0081, Val Loss: 0.1231 | Train Acc#: 0.9981, Val Acc#: 0.9739 | No improvement: 2/30

============================================================
Epoch 11/30
============================================================
Epoch 11/30 | Train Loss: 0.0068, Val Loss: 0.1178 | Train Acc#: 0.9989, Val Acc#: 0.9739 | No improvement: 3/30

============================================================
Epoch 12/30
============================================================
Epoch 12/30 | Train Loss: 0.0150, Val Loss: 0.1201 | Train Acc#: 0.9966, Val Acc#: 0.9774 | No improvement: 4/30
Saved best checkpoint: outputs/checkpoints/seq_blstm_mp_best.pth (Val Acc: 0.9774)

============================================================
Epoch 13/30
============================================================
Epoch 13/30 | Train Loss: 0.0069, Val Loss: 0.1074 | Train Acc#: 0.9981, Val Acc#: 0.9721 | No improvement: 5/30

============================================================
Epoch 14/30
============================================================
Epoch 14/30 | Train Loss: 0.0057, Val Loss: 0.1285 | Train Acc#: 0.9989, Val Acc#: 0.9721 | No improvement: 6/30

============================================================
Epoch 15/30
============================================================
Learning rate: 0.000058
Epoch 15/30 | Train Loss: 0.0053, Val Loss: 0.1080 | Train Acc#: 0.9989, Val Acc#: 0.9774 | No improvement: 7/30

============================================================
Epoch 16/30
============================================================
Epoch 16/30 | Train Loss: 0.0038, Val Loss: 0.0905 | Train Acc#: 0.9989, Val Acc#: 0.9808
Saved best checkpoint: outputs/checkpoints/seq_blstm_mp_best.pth (Val Acc: 0.9808)

============================================================
Epoch 17/30
============================================================
Epoch 17/30 | Train Loss: 0.0020, Val Loss: 0.0819 | Train Acc#: 0.9996, Val Acc#: 0.9826
Saved best checkpoint: outputs/checkpoints/seq_blstm_mp_best.pth (Val Acc: 0.9826)

============================================================
Epoch 18/30
============================================================
Epoch 18/30 | Train Loss: 0.0014, Val Loss: 0.0812 | Train Acc#: 0.9998, Val Acc#: 0.9843
Saved best checkpoint: outputs/checkpoints/seq_blstm_mp_best.pth (Val Acc: 0.9843)

============================================================
Epoch 19/30
============================================================
Epoch 19/30 | Train Loss: 0.0026, Val Loss: 0.0828 | Train Acc#: 0.9996, Val Acc#: 0.9843 | No improvement: 1/30

============================================================
Epoch 20/30
============================================================
Learning rate: 0.000031
Epoch 20/30 | Train Loss: 0.0023, Val Loss: 0.0955 | Train Acc#: 0.9994, Val Acc#: 0.9843 | No improvement: 2/30

============================================================
Epoch 21/30
============================================================
Epoch 21/30 | Train Loss: 0.0028, Val Loss: 0.0858 | Train Acc#: 0.9994, Val Acc#: 0.9843 | No improvement: 3/30

============================================================
Epoch 22/30
============================================================
Epoch 22/30 | Train Loss: 0.0015, Val Loss: 0.0826 | Train Acc#: 0.9998, Val Acc#: 0.9843 | No improvement: 4/30

============================================================
Epoch 23/30
============================================================
Epoch 23/30 | Train Loss: 0.0014, Val Loss: 0.0834 | Train Acc#: 0.9998, Val Acc#: 0.9861 | No improvement: 5/30
Saved best checkpoint: outputs/checkpoints/seq_blstm_mp_best.pth (Val Acc: 0.9861)

============================================================
Epoch 24/30
============================================================
Epoch 24/30 | Train Loss: 0.0012, Val Loss: 0.0839 | Train Acc#: 0.9998, Val Acc#: 0.9826 | No improvement: 6/30

============================================================
Epoch 25/30
============================================================
Learning rate: 0.000010
Epoch 25/30 | Train Loss: 0.0012, Val Loss: 0.0844 | Train Acc#: 0.9996, Val Acc#: 0.9826 | No improvement: 7/30

============================================================
Epoch 26/30
============================================================
Epoch 26/30 | Train Loss: 0.0031, Val Loss: 0.0786 | Train Acc#: 0.9994, Val Acc#: 0.9861

============================================================
Epoch 27/30
============================================================
Epoch 27/30 | Train Loss: 0.0011, Val Loss: 0.0799 | Train Acc#: 0.9998, Val Acc#: 0.9843 | No improvement: 1/30

============================================================
Epoch 28/30
============================================================
Epoch 28/30 | Train Loss: 0.0017, Val Loss: 0.0856 | Train Acc#: 0.9996, Val Acc#: 0.9843 | No improvement: 2/30

============================================================
Epoch 29/30
============================================================
Epoch 29/30 | Train Loss: 0.0014, Val Loss: 0.0851 | Train Acc#: 0.9998, Val Acc#: 0.9826 | No improvement: 3/30

============================================================
Epoch 30/30
============================================================
Learning rate: 0.000000
Epoch 30/30 | Train Loss: 0.0012, Val Loss: 0.0955 | Train Acc#: 0.9996, Val Acc#: 0.9843 | No improvement: 4/30

Evaluating on test set with best model...
Test Metrics:
  Loss: 0.1117
  Acc Number: 0.9759
  Acc Tens: 0.9966
  Acc Ones: 0.9777
