Starting training for seq_urnn_fs model
Device: cuda, Epochs: 30, Batch size: 64
LR: 0.001, Warmup: 1 epochs, Grad clip: 1.0
Mixed precision: True
Early stopping: patience=30 epochs (based on val loss)

============================================================
Epoch 1/30
============================================================
Learning rate: 0.000001
Epoch 1/30 | Train Loss: 2.7687, Val Loss: 1.2692 | Train Acc#: 0.2761, Val Acc#: 0.5575
Saved best checkpoint: outputs/checkpoints/seq_urnn_fs_best.pth (Val Acc: 0.5575)

============================================================
Epoch 2/30
============================================================
Epoch 2/30 | Train Loss: 0.8196, Val Loss: 0.5728 | Train Acc#: 0.7449, Val Acc#: 0.8380
Saved best checkpoint: outputs/checkpoints/seq_urnn_fs_best.pth (Val Acc: 0.8380)

============================================================
Epoch 3/30
============================================================
Epoch 3/30 | Train Loss: 0.3139, Val Loss: 0.3287 | Train Acc#: 0.9237, Val Acc#: 0.9094
Saved best checkpoint: outputs/checkpoints/seq_urnn_fs_best.pth (Val Acc: 0.9094)

============================================================
Epoch 4/30
============================================================
Epoch 4/30 | Train Loss: 0.1603, Val Loss: 0.2361 | Train Acc#: 0.9673, Val Acc#: 0.9390
Saved best checkpoint: outputs/checkpoints/seq_urnn_fs_best.pth (Val Acc: 0.9390)

============================================================
Epoch 5/30
============================================================
Learning rate: 0.000097
Epoch 5/30 | Train Loss: 0.0986, Val Loss: 0.2702 | Train Acc#: 0.9782, Val Acc#: 0.9216 | No improvement: 1/30

============================================================
Epoch 6/30
============================================================
Epoch 6/30 | Train Loss: 0.0613, Val Loss: 0.2591 | Train Acc#: 0.9876, Val Acc#: 0.9338 | No improvement: 2/30

============================================================
Epoch 7/30
============================================================
Epoch 7/30 | Train Loss: 0.0481, Val Loss: 0.2480 | Train Acc#: 0.9897, Val Acc#: 0.9286 | No improvement: 3/30

============================================================
Epoch 8/30
============================================================
Epoch 8/30 | Train Loss: 0.0409, Val Loss: 0.2231 | Train Acc#: 0.9912, Val Acc#: 0.9443
Saved best checkpoint: outputs/checkpoints/seq_urnn_fs_best.pth (Val Acc: 0.9443)

============================================================
Epoch 9/30
============================================================
Epoch 9/30 | Train Loss: 0.0258, Val Loss: 0.1699 | Train Acc#: 0.9944, Val Acc#: 0.9512
Saved best checkpoint: outputs/checkpoints/seq_urnn_fs_best.pth (Val Acc: 0.9512)

============================================================
Epoch 10/30
============================================================
Learning rate: 0.000082
Epoch 10/30 | Train Loss: 0.0248, Val Loss: 0.2820 | Train Acc#: 0.9927, Val Acc#: 0.9286 | No improvement: 1/30

============================================================
Epoch 11/30
============================================================
Epoch 11/30 | Train Loss: 0.0243, Val Loss: 0.1509 | Train Acc#: 0.9949, Val Acc#: 0.9582
Saved best checkpoint: outputs/checkpoints/seq_urnn_fs_best.pth (Val Acc: 0.9582)

============================================================
Epoch 12/30
============================================================
Epoch 12/30 | Train Loss: 0.0116, Val Loss: 0.1409 | Train Acc#: 0.9979, Val Acc#: 0.9652
Saved best checkpoint: outputs/checkpoints/seq_urnn_fs_best.pth (Val Acc: 0.9652)

============================================================
Epoch 13/30
============================================================
Epoch 13/30 | Train Loss: 0.0103, Val Loss: 0.1830 | Train Acc#: 0.9979, Val Acc#: 0.9512 | No improvement: 1/30

============================================================
Epoch 14/30
============================================================
Epoch 14/30 | Train Loss: 0.0063, Val Loss: 0.1637 | Train Acc#: 0.9987, Val Acc#: 0.9617 | No improvement: 2/30

============================================================
Epoch 15/30
============================================================
Learning rate: 0.000058
Epoch 15/30 | Train Loss: 0.0065, Val Loss: 0.1248 | Train Acc#: 0.9991, Val Acc#: 0.9686
Saved best checkpoint: outputs/checkpoints/seq_urnn_fs_best.pth (Val Acc: 0.9686)

============================================================
Epoch 16/30
============================================================
Epoch 16/30 | Train Loss: 0.0064, Val Loss: 0.1336 | Train Acc#: 0.9983, Val Acc#: 0.9652 | No improvement: 1/30

============================================================
Epoch 17/30
============================================================
Epoch 17/30 | Train Loss: 0.0045, Val Loss: 0.1421 | Train Acc#: 0.9991, Val Acc#: 0.9634 | No improvement: 2/30

============================================================
Epoch 18/30
============================================================
Epoch 18/30 | Train Loss: 0.0042, Val Loss: 0.1118 | Train Acc#: 0.9994, Val Acc#: 0.9686

============================================================
Epoch 19/30
============================================================
Epoch 19/30 | Train Loss: 0.0049, Val Loss: 0.1367 | Train Acc#: 0.9991, Val Acc#: 0.9686 | No improvement: 1/30

============================================================
Epoch 20/30
============================================================
Learning rate: 0.000031
Epoch 20/30 | Train Loss: 0.0024, Val Loss: 0.1332 | Train Acc#: 0.9998, Val Acc#: 0.9704 | No improvement: 2/30
Saved best checkpoint: outputs/checkpoints/seq_urnn_fs_best.pth (Val Acc: 0.9704)

============================================================
Epoch 21/30
============================================================
Epoch 21/30 | Train Loss: 0.0038, Val Loss: 0.1327 | Train Acc#: 0.9991, Val Acc#: 0.9739 | No improvement: 3/30
Saved best checkpoint: outputs/checkpoints/seq_urnn_fs_best.pth (Val Acc: 0.9739)

============================================================
Epoch 22/30
============================================================
Epoch 22/30 | Train Loss: 0.0026, Val Loss: 0.1498 | Train Acc#: 0.9996, Val Acc#: 0.9704 | No improvement: 4/30

============================================================
Epoch 23/30
============================================================
Epoch 23/30 | Train Loss: 0.0033, Val Loss: 0.1678 | Train Acc#: 0.9994, Val Acc#: 0.9617 | No improvement: 5/30

============================================================
Epoch 24/30
============================================================
Epoch 24/30 | Train Loss: 0.0022, Val Loss: 0.1576 | Train Acc#: 0.9998, Val Acc#: 0.9652 | No improvement: 6/30

============================================================
Epoch 25/30
============================================================
Learning rate: 0.000010
Epoch 25/30 | Train Loss: 0.0038, Val Loss: 0.1417 | Train Acc#: 0.9994, Val Acc#: 0.9634 | No improvement: 7/30

============================================================
Epoch 26/30
============================================================
Epoch 26/30 | Train Loss: 0.0019, Val Loss: 0.1574 | Train Acc#: 0.9998, Val Acc#: 0.9634 | No improvement: 8/30

============================================================
Epoch 27/30
============================================================
Epoch 27/30 | Train Loss: 0.0025, Val Loss: 0.1596 | Train Acc#: 0.9996, Val Acc#: 0.9617 | No improvement: 9/30

============================================================
Epoch 28/30
============================================================
Epoch 28/30 | Train Loss: 0.0019, Val Loss: 0.1486 | Train Acc#: 0.9998, Val Acc#: 0.9634 | No improvement: 10/30

============================================================
Epoch 29/30
============================================================
Epoch 29/30 | Train Loss: 0.0021, Val Loss: 0.1525 | Train Acc#: 0.9998, Val Acc#: 0.9617 | No improvement: 11/30

============================================================
Epoch 30/30
============================================================
Learning rate: 0.000000
Epoch 30/30 | Train Loss: 0.0022, Val Loss: 0.1503 | Train Acc#: 0.9998, Val Acc#: 0.9669 | No improvement: 12/30

Evaluating on test set with best model...
Test Metrics:
  Loss: 0.1453
  Acc Number: 0.9708
  Acc Tens: 0.9931
  Acc Ones: 0.9742
