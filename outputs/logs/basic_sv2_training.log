Starting training for basic_sv2 model
Device: cuda, Epochs: 30, Batch size: 64
LR: 0.001, Warmup: 1 epochs, Grad clip: 1.0
Mixed precision: True
Early stopping: patience=30 epochs (based on val loss)

============================================================
Epoch 1/30
============================================================
Learning rate: 0.000014
Epoch 1/30 | Train Loss: 3.4942, Val Loss: 1.4309 | Train Acc#: 0.3285, Val Acc#: 0.4669
Saved best checkpoint: outputs/checkpoints/basic_sv2_best.pth (Val Acc: 0.4669)

============================================================
Epoch 2/30
============================================================
Epoch 2/30 | Train Loss: 0.9917, Val Loss: 0.8323 | Train Acc#: 0.6452, Val Acc#: 0.6934
Saved best checkpoint: outputs/checkpoints/basic_sv2_best.pth (Val Acc: 0.6934)

============================================================
Epoch 3/30
============================================================
Epoch 3/30 | Train Loss: 0.5469, Val Loss: 0.5245 | Train Acc#: 0.8184, Val Acc#: 0.8345
Saved best checkpoint: outputs/checkpoints/basic_sv2_best.pth (Val Acc: 0.8345)

============================================================
Epoch 4/30
============================================================
Epoch 4/30 | Train Loss: 0.3479, Val Loss: 0.4485 | Train Acc#: 0.8969, Val Acc#: 0.8624
Saved best checkpoint: outputs/checkpoints/basic_sv2_best.pth (Val Acc: 0.8624)

============================================================
Epoch 5/30
============================================================
Learning rate: 0.000974
Epoch 5/30 | Train Loss: 0.2468, Val Loss: 0.5136 | Train Acc#: 0.9245, Val Acc#: 0.8293 | No improvement: 1/30

============================================================
Epoch 6/30
============================================================
Epoch 6/30 | Train Loss: 0.1895, Val Loss: 0.3697 | Train Acc#: 0.9435, Val Acc#: 0.8728
Saved best checkpoint: outputs/checkpoints/basic_sv2_best.pth (Val Acc: 0.8728)

============================================================
Epoch 7/30
============================================================
Epoch 7/30 | Train Loss: 0.1515, Val Loss: 0.5334 | Train Acc#: 0.9547, Val Acc#: 0.8432 | No improvement: 1/30

============================================================
Epoch 8/30
============================================================
Epoch 8/30 | Train Loss: 0.1452, Val Loss: 0.3477 | Train Acc#: 0.9559, Val Acc#: 0.9059
Saved best checkpoint: outputs/checkpoints/basic_sv2_best.pth (Val Acc: 0.9059)

============================================================
Epoch 9/30
============================================================
Epoch 9/30 | Train Loss: 0.1189, Val Loss: 0.2899 | Train Acc#: 0.9658, Val Acc#: 0.9268
Saved best checkpoint: outputs/checkpoints/basic_sv2_best.pth (Val Acc: 0.9268)

============================================================
Epoch 10/30
============================================================
Learning rate: 0.000824
Epoch 10/30 | Train Loss: 0.0929, Val Loss: 0.3275 | Train Acc#: 0.9743, Val Acc#: 0.9164 | No improvement: 1/30

============================================================
Epoch 11/30
============================================================
Epoch 11/30 | Train Loss: 0.0890, Val Loss: 0.3781 | Train Acc#: 0.9760, Val Acc#: 0.8833 | No improvement: 2/30

============================================================
Epoch 12/30
============================================================
Epoch 12/30 | Train Loss: 0.0732, Val Loss: 0.3076 | Train Acc#: 0.9763, Val Acc#: 0.9233 | No improvement: 3/30

============================================================
Epoch 13/30
============================================================
Epoch 13/30 | Train Loss: 0.0588, Val Loss: 0.2800 | Train Acc#: 0.9829, Val Acc#: 0.9199

============================================================
Epoch 14/30
============================================================
Epoch 14/30 | Train Loss: 0.0533, Val Loss: 0.3195 | Train Acc#: 0.9844, Val Acc#: 0.9216 | No improvement: 1/30

============================================================
Epoch 15/30
============================================================
Learning rate: 0.000581
Epoch 15/30 | Train Loss: 0.0402, Val Loss: 0.2698 | Train Acc#: 0.9887, Val Acc#: 0.9268

============================================================
Epoch 16/30
============================================================
Epoch 16/30 | Train Loss: 0.0270, Val Loss: 0.2947 | Train Acc#: 0.9914, Val Acc#: 0.9199 | No improvement: 1/30

============================================================
Epoch 17/30
============================================================
Epoch 17/30 | Train Loss: 0.0349, Val Loss: 0.3378 | Train Acc#: 0.9906, Val Acc#: 0.9233 | No improvement: 2/30

============================================================
Epoch 18/30
============================================================
Epoch 18/30 | Train Loss: 0.0222, Val Loss: 0.2797 | Train Acc#: 0.9934, Val Acc#: 0.9303 | No improvement: 3/30
Saved best checkpoint: outputs/checkpoints/basic_sv2_best.pth (Val Acc: 0.9303)

============================================================
Epoch 19/30
============================================================
Epoch 19/30 | Train Loss: 0.0166, Val Loss: 0.2544 | Train Acc#: 0.9951, Val Acc#: 0.9390
Saved best checkpoint: outputs/checkpoints/basic_sv2_best.pth (Val Acc: 0.9390)

============================================================
Epoch 20/30
============================================================
Learning rate: 0.000315
Epoch 20/30 | Train Loss: 0.0121, Val Loss: 0.2485 | Train Acc#: 0.9962, Val Acc#: 0.9390

============================================================
Epoch 21/30
============================================================
Epoch 21/30 | Train Loss: 0.0091, Val Loss: 0.2722 | Train Acc#: 0.9979, Val Acc#: 0.9373 | No improvement: 1/30

============================================================
Epoch 22/30
============================================================
Epoch 22/30 | Train Loss: 0.0084, Val Loss: 0.2658 | Train Acc#: 0.9974, Val Acc#: 0.9338 | No improvement: 2/30

============================================================
Epoch 23/30
============================================================
Epoch 23/30 | Train Loss: 0.0084, Val Loss: 0.2400 | Train Acc#: 0.9970, Val Acc#: 0.9460
Saved best checkpoint: outputs/checkpoints/basic_sv2_best.pth (Val Acc: 0.9460)

============================================================
Epoch 24/30
============================================================
Epoch 24/30 | Train Loss: 0.0080, Val Loss: 0.2757 | Train Acc#: 0.9976, Val Acc#: 0.9408 | No improvement: 1/30

============================================================
Epoch 25/30
============================================================
Learning rate: 0.000102
Epoch 25/30 | Train Loss: 0.0057, Val Loss: 0.2964 | Train Acc#: 0.9983, Val Acc#: 0.9303 | No improvement: 2/30

============================================================
Epoch 26/30
============================================================
Epoch 26/30 | Train Loss: 0.0052, Val Loss: 0.2805 | Train Acc#: 0.9989, Val Acc#: 0.9355 | No improvement: 3/30

============================================================
Epoch 27/30
============================================================
Epoch 27/30 | Train Loss: 0.0053, Val Loss: 0.2814 | Train Acc#: 0.9987, Val Acc#: 0.9460 | No improvement: 4/30

============================================================
Epoch 28/30
============================================================
Epoch 28/30 | Train Loss: 0.0096, Val Loss: 0.2679 | Train Acc#: 0.9979, Val Acc#: 0.9408 | No improvement: 5/30

============================================================
Epoch 29/30
============================================================
Epoch 29/30 | Train Loss: 0.0043, Val Loss: 0.2762 | Train Acc#: 0.9987, Val Acc#: 0.9303 | No improvement: 6/30

============================================================
Epoch 30/30
============================================================
Learning rate: 0.000003
Epoch 30/30 | Train Loss: 0.0070, Val Loss: 0.2674 | Train Acc#: 0.9983, Val Acc#: 0.9390 | No improvement: 7/30

Evaluating on test set with best model...
Test Metrics:
  Loss: 0.3427
  Acc Number: 0.9313
  Acc Tens: 0.9880
  Acc Ones: 0.9364
